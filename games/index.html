<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <style>
        :root{
            --color--border:  rgba(22, 22, 22, 0.767);
            --color--screen--canvas: #a1b877;
            --color--nintendo: rgb(51, 42, 131);
            --color--screen: rgb(77, 76, 76);
            --color--fondo--buttonArc: rgba(238, 19, 19, 0.726);
            --color--texto: #2F3A1F

        }
        body{
            background-color: #48e;
            height: 100dvh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: sans-serif;
        }
        button:focus{
            outline: none;
            caret-color: transparent; /*TO DELETE THE FOCUS OF THE BUTTON*/
        }
        .nintendo{
            background-color: var(--color--nintendo);
            border: 3px solid var(--color--border);
            border-radius: 10px;
            width: 350px;
            height: 550px;
            padding:10px;
            display: flex;
            align-items: center;
            flex-direction: column;
            gap: 30px;
            box-shadow: 8px 8px 8px var(--color--border);
        }

        .screen{
            position: relative;
            border: 3px solid var(--color--border);
            background-color: var(--color--screen);
            width: 330px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            
        }
        /*SCREEN-CANVAS*/
        canvas{
            width: 250px;
            height: 275px;
            margin-top: 10px;
            margin-bottom: 10px;
            border: 3px solid var(--color--border);
            background-color: var(--color--screen--canvas);
        }
        /*MESSAGE OF GAME OVER*/
        .message{
            position: absolute;
            display: none;
            border: 4px dashed var(--color--border);
            background-color: var(--color--screen--canvas);
            color: var(--color--texto);
            border-radius: 10px;
            padding: 10px;
        }
        .message h1,label{
            -webkit-text-stroke: 1px black;
        }

        /*THIS CODE IS TO THE KEYS OF THE NINTENDO*/
        .keyboard{
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            width: 330px;
        }   

        /*THE DIV 1 OF THE BUTTON UP, DOWN, LEFT, RIGHT*/
        .keyboardPartOne{
            display: flex;
            flex-direction: column;
        }
        .keyboardPartOne div{
            display: flex;
            justify-content: center;
            padding-top: 13px;
            gap: 20px;
        }

        

        /*THE DIV 2 OF THE BUTTON JUMP AND CROUCH*/
        .keyboardPartTwo{   
            display: flex;
        }
        .keyboardPartTwo button:first-of-type {
             margin-top: 35px;  
        }

        .buttonArc{
            width: 60px;
            height: 60px;
            border: 2px solid var(--color--border);
            border-radius: 50%;
            background-color: var(--color--fondo--buttonArc);
        }
        /*Effects for when We are pressing the keys*/
        .buttonArc:active,.buttonRestart:active{
            transform: scale(0.95);
        }
        .buttonLeft {
            transform: rotate(180deg);
        }
        .buttonUp {
            transform: rotate(270deg);
        }
        .buttonDown{
            transform: rotate(90deg);
        }
        
        
        /*The DIV 3 of the BUTTON RESERT*/
        .keyboardPartThree{
            display: flex;
            justify-content: center;
        }
        .keyboardPartThree button{
            width: 60px;
            height: 28px;
            border-radius: 10px;
            background-color: var(--color--screen);
            border: 2px solid var(--color--border);
        }
        /*MEDIA QUERIES*/
        /*SCREEN OF 370 PX OR LESS*/
        @media screen and (max-width:370px) {
            .nintendo{
                width: 315px;
                height: 550px;
            }
            .screen{
                width: 295px;
                height: 300px;  
            }
            .keyboard{
                width: 295px;
            }
        }
         /*SCREEN OF 370 PX OR LESS*/
        @media screen and (max-width:1070px) and (min-width:700px)and (min-height:700px) {
            .nintendo{
                width: 395px;
                height: 650px;

            }
            .screen{
                width: 375px;
                height: 300px;  
                margin-top: 20px;
                margin-bottom: 25px;
            }
            canvas{
                width: 290px;
            }
            .keyboard{
                width: 363px;
            }
        }
    </style>
    <title>Animar</title>
</head>
<body>
    <div class="nintendo">
        <div class="screen">
            <canvas id="canvas" width="290" height="310"></canvas>
            <div class="message" translate="no">
                <h1>GAME OVER</h1>
                <label>SCORE:</label> <label class="score"></label>
            </div>
        </div>
        <div class="keyboard">
            <div class="keyboardPartOne">
                <div>
                    <button class="buttonArc buttonLeft"><i class="bx bx-play"></i></button>
                    <button class="buttonArc buttonRight"><i class="bx bx-play"></i></button>
                </div>
            </div>
            <div class="keyboardPartTwo">
                <button class="buttonArc buttonDown"><i class="bx bx-play"></i></button>
                <button class="buttonArc buttonUp"><i class="bx bx-play"></i></button>
            </div>
        </div>
        <div class="keyboardPartThree">
            <button class="buttonRestart"></button>
        </div>
    </div>
    
    <script>
        const message = document.querySelector(".message")

        /*getting the BUTTON of the HTML*/
        const score = document.querySelector(".score")
        const buttonRestart= document.querySelector(".buttonRestart")
        const buttonUp= document.querySelector(".buttonUp")
        const buttonLeft= document.querySelector(".buttonLeft")
        const buttonRight= document.querySelector(".buttonRight")
        const buttonDown= document.querySelector(".buttonDown")

        const canvas = document.querySelector("#canvas")
        const ctx = canvas.getContext("2d")

        let velocidad = 12 // speed of the Snake
        let velocidad2 = 10 // Increase speed
        let contFood = 0 // ContFood 

        //DRAWING THE FOOD
        let food = {
                x: 200,
                y: 150
            }

        function drawFood(){
            ctx.fillStyle = "yellow"
            ctx.fillRect(food.x, food.y, box, box)
        }

        //DRAWING SNAKE
        const box = 10 

        let snake = [
            { x: 100, y: 100 }, // HEAD
            { x: 90,  y: 100 }, // BODY
            { x: 80,  y: 100 } // FEET
        ]
    
        function drawSnake(){
            ctx.fillStyle = "#333333"
            snake.forEach(item => {
                ctx.fillRect(item.x,item.y,box,box)
            });
        }

        //Colition of the snake with herself
        function colition (){
            let i = 1
            let answer = false
            while (i < snake.length && (!answer)){
                if (snake[i].x === snake[0].x && snake[i].y === snake[0].y){
                    answer = !answer
                }
                i++
            }
            return answer
        }

        //MOVE THE SNAKE
        let pressedRight = false 
        let pressedLeft = false 
        let pressedTop = false 
        let pressedBottom = false
        let gameOver = false
        
       function SnakeMovement(){
            const head = { ...snake[0] }

            
            if (pressedTop) head.y -= box
            else if (pressedBottom) head.y += box
            else if (pressedLeft) head.x -= box
            else if (pressedRight) head.x += box
            else return

            snake.unshift(head)
            // eat
            if (head.x === food.x && head.y === food.y) {
                FoodMovement() // creat new food
                contFood++
            } else {
                snake.pop()
            }

            // outside of the screem
            if (
                head.x < 0 ||
                head.x >= canvas.width ||
                head.y < 0 ||
                head.y >= canvas.height || colition()
            ) {
                gameOver = true
                message.style.display = "block"
                score.textContent = contFood
            }
        }


        //Detect Events of the keyboard
        function initEvents(){
            //Code of the MÃ³bile

            //BUTTON DOWN
            buttonDown.addEventListener("click",()=>{
                if (pressedTop) return 

                    pressedBottom = true
                    pressedTop = false
                    pressedLeft = false
                    pressedRight = false
            })  
            //BUTTON LEFT
            buttonLeft.addEventListener("click",()=>{
                if (pressedRight) return

                    pressedLeft = true
                    pressedTop = false
                    pressedBottom = false
                    pressedRight = false
            })
            //BUTTON Right
            buttonRight.addEventListener("click",()=>{
                if (pressedLeft) return

                    pressedRight = true
                    pressedTop = false
                    pressedBottom = false
                    pressedLeft = false
            })
            //BUTTON UP
            buttonUp.addEventListener("click",()=>{
                if (pressedBottom) return 

                    pressedTop = true
                    pressedBottom = false
                    pressedLeft = false
                    pressedRight = false

            })


            //Code to the PC
            document.addEventListener("keydown",presionarTecla)
            
            //Press keys
            function presionarTecla (e){
                const key = e.key
                        
                // TOP
                if (key === "ArrowUp") {
                    if (pressedBottom) return 

                    pressedTop = true
                    pressedBottom = false
                    pressedLeft = false
                    pressedRight = false
                }

                // BOTTOM
                else if (key === "ArrowDown") {
                    if (pressedTop) return 

                    pressedBottom = true
                    pressedTop = false
                    pressedLeft = false
                    pressedRight = false
                }

                // LEFT
                else if (key === "ArrowLeft") {
                    if (pressedRight) return

                    pressedLeft = true
                    pressedTop = false
                    pressedBottom = false
                    pressedRight = false
                }

                // RIGHT
                else if (key === "ArrowRight") {
                    if (pressedLeft) return

                    pressedRight = true
                    pressedTop = false
                    pressedBottom = false
                    pressedLeft = false
                }
            }
        }


        //MOVEMENT OF THE FOOD
        function FoodMovement(){
            food = {
                    x: Math.floor(Math.random() * (canvas.width / box)) * box,
                    y: Math.floor(Math.random() * (canvas.height / box)) * box
                }
        }

        //Clean all the Canvas 
        function cleanCanvas(){
             ctx.clearRect(0,0,canvas.width,canvas.height)
        }

        //Reset all the Game and the Characters
        function resetGame(){
            food = {
                x: 200,
                y: 150
            }
            snake = [
                { x: 100, y: 100 }, // HEAD
                { x: 90,  y: 100 }, // BODY
                { x: 80,  y: 100 } // FEET
            ]
            velocidad = 12
            contador = 0
            contFood = 0 
            pressedBottom = false
            pressedLeft = false
            pressedRight = false
            pressedTop = false

            message.style.display = "none"

        }


        //DRAW ALL THE OBJECTS
        let contador = 0
        let idAnimation = null

       function draw(){
        if (gameOver)return
        cleanCanvas() 
        drawSnake()
        contador++
        if (contador >= velocidad) {
            if (contFood > 25){
                velocidad =  velocidad2
            }
            SnakeMovement()  // only move every X frames
            contador = 0
        }
        drawFood()
        idAnimation = requestAnimationFrame(draw)
       }

       /*First time that we called the funtion draw() and initEvents()*/
        draw()
        initEvents()

        /*This is to reset all the game*/
        buttonRestart.addEventListener("click",()=>{
            cancelAnimationFrame(idAnimation)
            gameOver = false
            resetGame()
            draw()
        })
    </script>
</body>

</html>



